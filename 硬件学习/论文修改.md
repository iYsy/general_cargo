## **2.2** **USART串口通讯**

USART（Universal Synchronous Asynchronous Receiver Transmitter）是一种通用的串行通信接口，常用于微控制器和外部设备之间的数据传输。它支持同步和异步通信，并提供了多种通信模式和配置选项，适用于不同的应用场景。

## **2.2****.1** **使用原因**

本系统使用该方式进行串口通信的原因如下：

1) 灵活性： USART串口通讯支持同步和异步两种通信模式，因此具有较高的灵活性。在同步模式下，通信双方使用共同的时钟信号进行数据传输，能够实现高速数据传输；而在异步模式下，通信双方使用各自独立的时钟信号，适用于长距离传输和不需要高速传输的场景。

2) 广泛应用： USART串口通讯被广泛应用于各种嵌入式系统和通信设备中，如单片机、传感器、模块设备等。由于其通信简单、稳定可靠的特点，适用于各种环境和场景的数据传输需求。

3) 高效性： USART串口通讯具有较高的传输效率。在异步模式下，通信双方使用起始位、数据位、停止位等标准格式进行数据传输，无需额外的时钟信号，能够实现简单高效的数据通信。

4) 低成本： USART串口通讯所需的硬件资源简单、成本较低。仅需要少量的引脚和外围电路即可实现通信功能，适用于对硬件成本有要求的应用场景。

5) 易于实现： USART串口通讯的协议相对简单，易于理解和实现。通信双方只需遵循一定的通信规范和协议，即可实现数据的可靠传输，无需复杂的通信协议和算法支持。

 

## **2.2****.2** **USART串口通讯原理**

\1. 数据传输方式：

USART串口通讯通过串行方式在两个设备之间传输数据。数据在传输过程中以位的形式进行，即每个数据字节被分解成一串位依次传输，通常是从最高位到最低位的顺序。

\2. 同步和异步模式：

USART支持同步和异步两种通信模式。

1) 在同步模式下，通信双方使用共同的时钟信号进行数据传输，数据的发送和接收都依赖于这个时钟信号的同步。这种模式适用于高速传输，但对于长距离传输可能存在时钟同步问题。

2) 在异步模式下，通信双方使用各自独立的时钟信号进行数据传输。通信的开始和结束由起始位和停止位标识。异步模式适用于长距离传输和不需要高速传输的场合。

\3. 通信参数：

USART通信需要指定一些参数，包括波特率、数据位、停止位、校验位等。

波特率表示每秒钟传输的位数，决定了数据传输的速率。数据位表示每个数据字节中有多少位用于数据传输，通常为8位。停止位表示数据字节结束的标志位，一般为1位。校验位用于检测传输过程中的错误。这些参数需要通信的双方提前协商好，并在通信过程中保持一致，以确保数据的正确传输。

\4. 数据传输流程：

在USART串口通讯中，数据的传输流程通常包括以下步骤：

1) 发送端将要发送的数据按照指定的格式发送到串口发送缓冲区。

2) 发送端通过串口发送电路将数据转换为串行数据流，并以指定的波特率发送出去。

3) 接收端接收串行数据流，并根据指定的参数解析出有效的数据。

4) 接收端将接收到的数据存储到接收缓冲区，供上层应用程序处理。

 

## **2.3** **QT开发环境**

QT是一套跨平台的C++图形用户界面应用程序开发框架，由Qt Company开发。它提供了一整套用于开发图形用户界面、网络应用、数据库驱动、音频/视频播放等功能的工具和类库，被广泛应用于桌面应用、移动应用和嵌入式系统等领域。具有以下特点：

\1. 跨平台性：

QT开发环境具有出色的跨平台性，开发者可以使用相同的代码库在不同的操作系统上进行开发，如Windows、macOS、Linux等。QT的跨平台性体现在其良好的兼容性和一致的API设计上，使得开发者能够更便捷地进行跨平台应用的开发和维护。

\2. 集成开发环境（IDE）：

QT Creator是QT的官方集成开发环境，提供了丰富的开发工具和功能，包括代码编辑器、可视化界面设计器、调试器、编译器等。QT Creator支持C++语言开发，具有智能代码补全、语法高亮、调试功能等，能够帮助开发者提高开发效率。

\3. 丰富的类库：

QT提供了丰富的类库，涵盖了图形界面、网络通信、数据库操作、多媒体处理等各个方面的功能。这些类库都经过了充分测试和优化，具有高性能和稳定性，能够满足各种应用场景的需求。

\4. 可视化界面设计工具：

QT提供了Qt Designer等可视化界面设计工具，可以帮助开发者快速设计和布局用户界面。开发者可以通过拖拽组件、设置属性等简单操作，快速生成界面布局，并且无需手动编写复杂的UI代码。

 

**2.3.1** **信号与槽机制**

就我个人来理解，QT框架中的信号与槽机制是一种强大的事件处理和通信机制，用于连接不同对象之间的事件和槽函数，实现对象之间的松耦合通信。信号是特殊的成员函数，代表了某个事件的发生，而槽则是接收信号的函数，用于处理相应的事件。通过信号与槽的连接，当信号被触发时，与之相连接的槽函数会被自动调用。

1) 信号

当对象改变其状态时，信号就由该对象发射 (emit) 出去，而且对象只负责发送信号，它不知道另一端是谁在接收这个信号。这样就做到了真正的信息封装，能确保对象被当作一个真正的软件组件来使用。

2) 槽

用于接收信号，而且槽只是普通的对象成员函数。一个槽并不知道是否有任何信号与自己相连接。而且对象并不了解具体的通信机制。

3) 信号与槽的连接

所有从 QObject 或其子类 ( 例如 Qwidget ) 派生的类都能够包含信号和槽。因为信号与槽的连接是通过 QObject 的 connect() 成员函数来实现的。

 

**2.3.2** **C++**

QT中软件是通过C++语言来实现，具有三大基本特性：封装、继承、多态。

1) 封装：实现代码模块化。

2) 继承：实现代码扩展。

3) 多态：分为静态多态和动态多态。静态多态：函数重载和泛型编程。动态多态：虚函数重写。

 

## **2.4** **MySQL数据库管理**

数据库通过MySQL实现，其中包括用户数据、用户需求等等，用于前后端的交互，来实现数据的传输以及调用。具体设计如下：

1) 用户账号与密码：用来实现用户的登录与身份识别。

2) 设备地址：用于监控广告屏的位置，方便修改。

3) 设备状态：如开关状态等，便于后期维护。

4) 用户需求：即广告屏的内容选择，便于后期内容投放。







**3.2** **远程广告屏控制系统****各功能模块设计**

一、**STM32硬件模块**

在该远程广告屏控制系统的设计中，我使用的是STM32F103RCT6的开发板，该开发板有以下特点：

1) ARM Cortex-M3内核，工作频率可达72MHz，性能强劲。

2) 集成了丰富的外设，包括多个通用定时器、串行通信接口（USART、SPI、I2C等）、模拟至数模转换器（ADC）、PWM输出、以太网控制器等。

3) 具有多种低功耗模式，能够在不同场景下灵活运用，以节省能源。

4) 内置闪存和SRAM，可满足各种应用的存储需求。

5) 采用了现代化的工艺制造，具有较高的抗干扰能力和稳定性。

 

A. **功能模块实现**

a. 硬件的初始化设计

b. usart串口通信模块

在远程广告屏控制系统中，USART串口通信模块被设计为系统与外部设备之间进行数据传输的主要接口之一。该模块的实现包括串口初始化、数据发送和接收处理等功能。通过串口通信，系统能够与各类外部设备（如传感器、键盘、远程服务器等）进行数据交互，从而实现对广告屏的远程控制和监控。此外，为了提高系统的稳定性和可靠性，该模块还需要考虑数据校验和错误处理等机制，以确保数据的完整性和准确性。

c. lcd显示屏模块

LCD显示屏模块作为用户界面的重要组成部分，在远程广告屏控制系统中扮演着至关重要的角色。该模块的设计旨在实现对系统状态、运行信息以及接收到的广告内容等的实时显示。为此，需要进行LCD的初始化设置，并设计相应的显示内容控制逻辑和用户界面。通过合理的界面设计和信息展示，用户可以清晰地了解系统的运行状态和操作情况，从而更加方便地进行系统管理和控制。

 

B. **网络通信**

a. 使用USART串口通信

在远程广告屏控制系统中，采用USART串口通信方式实现系统与外部网络模块的连接是一种常见的做法。通过该通信方式，系统能够与远程服务器进行数据交互，实现对广告内容的远程更新和控制。为此，需要设计串口参数设置、数据发送与接收处理等功能，以确保系统与服务器之间的稳定通信。同时，还需要考虑数据传输的效率和安全性，采用适当的数据加密和压缩算法，以应对复杂的网络环境和数据传输需求。具体由第四章进行具体描述。

 

二、**QT软件设计**

A. **UI界面设计**

UI界面设计在QT软件中扮演着至关重要的角色，通过合理的布局和控件设计，能够为用户提供直观、友好的操作界面，实现对广告屏的远程控制和管理。

通过QT中信号与槽的设计与实现，可以轻松地将用户界面与后台逻辑进行连接，实现对软件中控件的设计。在UI界面设计中，需要考虑到用户的操作习惯和体验，合理地安排各个控件的位置和功能，使用户能够快速、准确地完成操作任务。例如，可以通过按钮、滑块、文本框等控件来实现对广告内容的选择、播放控制、参数设置等功能。

通过不同控件的设计，可以实现对广告屏的远程控制。例如，可以设计一个播放控制面板，包括播放、停止、暂停、调节音量等按钮，让用户可以方便地控制广告内容的播放状态。同时，还可以设计一个设置界面，包括网络参数设置、系统参数设置等，让用户可以根据实际需求对系统进行灵活配置。

 

 

 

B. **软件设计流程**

 

C. **软件代码展示**

D. **软件效果展示**

E. **网络通信模块**

网络模块是QT软件中实现服务器与客户端通信的关键部分，通过设计网络通信模块，能够实现与远程服务器的稳定连接和数据交互。

在设计网络模块时，需要考虑到网络通信的稳定性和安全性。通过使用QT提供的网络编程库，可以轻松地实现TCP/IP或UDP等网络协议的支持，确保数据的可靠传输。同时，还可以加入数据加密和身份验证等机制，保护用户数据的安全。

通过网络模块的设计，可以实现与服务器之间的实时通信。例如，可以设计一个数据传输模块，负责向服务器发送广告内容的请求，并接收服务器返回的数据，实现广告内容的远程更新和管理。同时，还可以设计一个状态监控模块，定期向服务器发送心跳包，以检测服务器的状态并及时处理异常情况。









**4.1** **硬件网络模块**

通过使用USART串口通信，进行数据的交互。

 

**4.****1.1 USART串口初始化**

 

**4.****1.2 USART串口的配置**

 

**4.2** **QT软件端的串口通信模块**

**4.****1.1 USART串口初始化**

 

**4.****1.2 USART串口的配置**